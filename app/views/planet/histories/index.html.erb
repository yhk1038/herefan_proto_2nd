<%= render partial: '/fandoms/partials/planet_header' %>

<%= render partial: '/layouts/sub_nav', locals: {tabs: @tabs} %>

<section id="content" class="m-t-30">

    <div class="container">
        <!--<div class="block-header">-->
            <!--<h2>Photo Gallery <small>JQuery lightGallery is a lightweight jQuery lightbox gallery for displaying image and video gallery</small></h2>-->

            <!--<ul class="actions">-->
                <!--<li>-->
                    <!--<a href="">-->
                        <!--<i class="zmdi zmdi-trending-up"></i>-->
                    <!--</a>-->
                <!--</li>-->
                <!--<li>-->
                    <!--<a href="">-->
                        <!--<i class="zmdi zmdi-check-all"></i>-->
                    <!--</a>-->
                <!--</li>-->
                <!--<li class="dropdown">-->
                    <!--<a href="" data-toggle="dropdown">-->
                        <!--<i class="zmdi zmdi-more-vert"></i>-->
                    <!--</a>-->

                    <!--<ul class="dropdown-menu dropdown-menu-right">-->
                        <!--<li>-->
                            <!--<a href="">Refresh</a>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<a href="">Manage Widgets</a>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<a href="">Widgets Settings</a>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</li>-->
            <!--</ul>-->

        <!--</div>-->

        <div class="row">
            <div class="col-md-12">
                <div class="card" id="history-index-wrap">
                    <div class="card-body card-padding">
                        <p>Edit Mode</p>
                        <% years = @histories.all.map{|history| history.event_date.year}.uniq %>
                        <ul>
                            <% years.each do |year| %>
                                <li><%= year %></li>
                            <% end %>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <!--
                    <div class="lv-header-alt clearfix">
                        <h2 class="lvh-label hidden-xs">Some text here</h2>

                        <div class="lvh-search">
                            <input type="text" placeholder="Start typing..." class="lvhs-input">

                            <i class="lvh-search-close">&times;</i>
                        </div>

                        <ul class="lv-actions actions">
                            <li>
                                <a href="">
                                    <i class="zmdi zmdi-time"></i>
                                </a>
                            </li>
                            <li class="dropdown">
                                <a href="" data-toggle="dropdown" aria-expanded="true">
                                    <i class="zmdi zmdi-sort"></i>
                                </a>

                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <a href="">Last Modified</a>
                                    </li>
                                    <li>
                                        <a href="">Last Edited</a>
                                    </li>
                                    <li>
                                        <a href="">Name</a>
                                    </li>
                                    <li>
                                        <a href="">Date</a>
                                    </li>
                                </ul>
                            </li>

                            <li>
                                <a href="">
                                    <i class="zmdi zmdi-info"></i>
                                </a>
                            </li>

                            <li>
                                <a href="" class="lvh-search-trigger">
                                    <i class="zmdi zmdi-search"></i>
                                </a>
                            </li>

                            <li class="dropdown">
                                <a href="" data-toggle="dropdown" aria-expanded="true">
                                    <i class="zmdi zmdi-more-vert"></i>
                                </a>

                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <a href="">Refresh</a>
                                    </li>
                                    <li>
                                        <a href="">Listview Settings</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    -->

                    <div class="card-body card-padding content-ground">

                        <!-- Add History line -->
                        <div class="p-timeline adding">
                            <div class="pt-line c-gray text-right">
                                <span class="d-block">Year</span> :d/ :m
                            </div>

                            <div class="pt-body">

                                <h2 class="ptb-title" id="timeline-add-title"><span>Add a new Line whenever you want :D</span>
                                    <a id="history_add_line-edit" href="#" class="btn btn-default feature feature-edit c-cyan" onclick="return false;">add</a>
                                </h2>

                                <div id="timeline-add-title-edit" class="input-group form-group" style="display: none;">
                                    <div class="fg-line">
                                        <input id="new-history-title" type="text" class="form-control" placeholder="Add a new Line whenever you want :D" autofocus required>
                                    </div>
                                    <div class="input-group form-group" style="width: 50%; float: right;">
                                        <span class="input-group-addon"><i class="zmdi zmdi-calendar"></i></span>
                                        <div class="dtp-container fg-line">
                                            <input type="text" class="form-control date-picker" id="history-event_date" placeholder="When was the event? ...">
                                        </div>
                                    </div>

                                    <span class="input-group-addon last">
                                        <a id="history_add_line-save" data-fandom="<%= @fandom.id %>" data-author="<%= $current_user_id %>" href="#" class="btn btn-default feature feature-edit c-cyan" onclick="return false;">save</a>
                                    </span>
                                </div>

                                <div class="pull-right" addkey="">
                                    <div class="lightbox-item2 item-plus-box">
                                        <a href="#" class="item-plus" data-title="Add a new Line whenever you want :D" data-history="0" data-toggle="modal" style="opacity: 0.25;" onclick="swal('History Event-Date First!');return false;"><span class="zmdi zmdi-plus-circle"></span></a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 바로 아래에 새로운 히스토리를 붙이는 위치 -->
                        <div id="target-zone"></div>


                        <% if @histories.count.zero? %>         <!-- Dummy for Nothing to show -->
                            <% dummy_history.reverse.each do |history| %>
                                <div class="p-timeline">
                                    <div class="pt-line c-gray text-right">
                                        <span class="d-block"><%= history[:event_date].year %></span> <%= history[:event_date].strftime('%d/%m') %>
                                    </div>

                                    <div class="pt-body">
                                        <h2 class="ptb-title" id="timeline-<%= history[:id] %>-title"><%= history[:title] %>
                                            <a href="#" class="btn btn-default feature feature-edit c-cyan" onclick="return false;">Edit</a>
                                        </h2>

                                        <div class="lightbox clearfix" data-history="timeline-<%= history[:id] %>">
                                            <% if history[:img] %>
                                                <div data-src="<%= history[:square_img] %>">
                                                    <div class="lightbox-item p-item">
                                                        <img src="<%= history[:img] %>" alt="" />
                                                    </div>
                                                </div>
                                            <% end %>
                                            <% history[:sub].each do |attachment| %>
                                                <div data-src="<%= attachment[:square_img] %>">
                                                    <div class="lightbox-item p-item">
                                                        <img src="<%= attachment[:img] %>" alt="" />
                                                    </div>
                                                </div>
                                            <% end %>
                                        </div>
                                        <div class="pull-right" addkey="">
                                            <div class="lightbox-item2 item-plus-box">
                                                <a href="#" class="item-plus" data-title="<%=  history[:title] %>" data-history="<%= history[:id] %>" data-toggle="modal" data-target="#imgUploadModal"><span class="zmdi zmdi-plus-circle"></span></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <% end %>
                        <% else %>                              <!-- Real history parse powered by partial template -->
                            <%= render partial: '/planet/histories/partials/event', collection: @histories, as: :history, locals: { new_history: false } %>
                        <% end %>


                        <div style="display: block;">
                            <div class="p-timeline">
                                <div class="pt-line c-gray text-right">
                                    <span class="d-block">2015</span>
                                    10/07
                                </div>

                                <div class="pt-body">
                                    <h2 class="ptb-title">Trip to Orbit</h2>

                                    <div class="lightbox clearfix">
                                        <div data-src="/template/media/gallery/10.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/10.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/11.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/11.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/12.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/12.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/13.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/13.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/14.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/14.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/15.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/15.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/16.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/16.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/17.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/17.jpg" alt="" />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="p-timeline">
                                <div class="pt-line c-gray text-right">
                                    <span class="d-block">2015</span>
                                    12/06
                                </div>

                                <div class="pt-body">
                                    <h2 class="ptb-title">Purchased for print</h2>

                                    <div class="lightbox clearfix">

                                        <div data-src="/template/media/gallery/4.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/4.jpg" alt="" />
                                            </div>
                                        </div>

                                        <div data-src="/template/media/gallery/5.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/5.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/6.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/6.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/7.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/7.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/8.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/8.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/9.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/9.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/10.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/10.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/11.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/11.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/12.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/12.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/13.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/13.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/14.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/14.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/15.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/15.jpg" alt="" />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="p-timeline">
                                <div class="pt-line c-gray text-right">
                                    <span class="d-block">2015</span>
                                    01/06
                                </div>

                                <div class="pt-body">
                                    <h2 class="ptb-title">For Website</h2>

                                    <div class="lightbox clearfix">
                                        <div data-src="/template/media/gallery/1.jpg">
                                            <div class="lightbox-item">
                                                <img src="/template/media/gallery/thumbs/1.jpg" alt="" />
                                            </div>
                                        </div>

                                        <div data-src="/template/media/gallery/2.jpg">
                                            <div class="lightbox-item">
                                                <img src="/template/media/gallery/thumbs/2.jpg" alt="" />
                                            </div>
                                        </div>

                                        <div data-src="/template/media/gallery/3.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/3.jpg" alt="" />
                                            </div>
                                        </div>

                                        <div data-src="/template/media/gallery/4.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/4.jpg" alt="" />
                                            </div>
                                        </div>

                                        <div data-src="/template/media/gallery/5.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/5.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/6.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/6.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/7.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/7.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/8.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/8.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/9.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/9.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/10.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/10.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/11.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/11.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/12.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/12.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/13.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/13.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/14.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/14.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/15.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/15.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/16.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/16.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/17.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/17.jpg" alt="" />
                                            </div>
                                        </div>

                                        <div data-src="/template/media/gallery/4.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/4.jpg" alt="" />
                                            </div>
                                        </div>

                                        <div data-src="/template/media/gallery/5.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/5.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/6.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/6.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/7.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/7.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/8.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/8.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/9.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/9.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/10.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/10.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/11.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/11.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/12.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/12.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/13.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/13.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/14.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/14.jpg" alt="" />
                                            </div>
                                        </div>
                                        <div data-src="/template/media/gallery/15.jpg">
                                            <div class="lightbox-item p-item">
                                                <img src="/template/media/gallery/thumbs/15.jpg" alt="" />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="p-timeline">
                            <div class="pt-line c-gray text-right">
                                <span class="d-block">2015</span>
                                22/04
                            </div>

                            <div class="pt-body">
                                <h2 class="ptb-title">To Print and Review</h2>

                                <div class="lightbox clearfix">
                                    <div data-src="/template/media/gallery/13.jpg">
                                        <div class="lightbox-item p-item">
                                            <img src="/template/media/gallery/thumbs/13.jpg" alt="" />
                                        </div>
                                    </div>
                                    <div data-src="/template/media/gallery/10.jpg">
                                        <div class="lightbox-item p-item">
                                            <img src="/template/media/gallery/thumbs/10.jpg" alt="" />
                                        </div>
                                    </div>
                                    <div data-src="/template/media/gallery/11.jpg">
                                        <div class="lightbox-item p-item">
                                            <img src="/template/media/gallery/thumbs/11.jpg" alt="" />
                                        </div>
                                    </div>
                                    <div data-src="/template/media/gallery/12.jpg">
                                        <div class="lightbox-item p-item">
                                            <img src="/template/media/gallery/thumbs/12.jpg" alt="" />
                                        </div>
                                    </div>
                                    <div data-src="/template/media/gallery/14.jpg">
                                        <div class="lightbox-item p-item">
                                            <img src="/template/media/gallery/thumbs/14.jpg" alt="" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

</section>
<span id="titleShadow"></span>



<!-- Modal -->
<div class="modal fade" id="imgUploadModal" tabindex="-1" role="dialog" aria-labelledby="imgUploadModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="imgUploadModalLabel">Modal title</h4>
            </div>
            <form action="/fandoms/<%= @fandom.id %>/histories" method="post" enctype="multipart/form-data">

                <input name="authenticity_token" id="inputHistory-authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
                <input type="hidden" name="history[history_id]" id="inputHistory-history_id">

                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="fileinput fileinput-new" data-provides="fileinput">
                                    <div class="fileinput-preview thumbnail" data-trigger="fileinput" style="line-height: 150px;"></div>
                                    <div>
                                        <span class="btn btn-info btn-file waves-effect w-100">
                                            <span class="fileinput-new">Select image</span>
                                            <span class="fileinput-exists">Change</span>
                                            <input type="hidden"><input type="file" name="history[img]">
                                        </span>
                                        <a href="#" class="btn btn-danger fileinput-exists waves-effect w-100" data-dismiss="fileinput">Remove</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" style="display: none">
                                <div class="card">
                                    <div class="card-boddy card-padding">
                                        <a href="#" class="btn btn-info fileinput-exists w-100" data-dismiss="fileinput" style="text-align: center; text-transform: capitalize">Save & Add Another</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save changes</button>
                </div>
            </form>
        </div>
    </div>
</div>