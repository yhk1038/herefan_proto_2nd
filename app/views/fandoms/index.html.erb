<%= render partial: '/layouts/plane_header', locals: { color_class: 'bgm-green', message: 'Choose the channel you want to follow!', style: '', msg_style: '' } %>

<% if user_signed_in? %>
    <button id="suggest_btn" class="btn btn-default bgm-lightgreen wave-effect" data-toggle="modal" data-target="#suggest_channel_modal">
        Do you want to suggest a new Channel?
    </button>
<% end %>

<section id="sorting_methods" class="container">
    <div class="row">
        <div class="col-sm-6"></div>
        <div class="col-sm-6">
            <div class="col-md-4"></div>
            <div class="col-md-8">
                <ul class="methods-wrapper">
                    <label class="radio radio-inline">
                        <input type="radio" name="sort_option" value="popular" checked>
                        <i class="input-helper"></i>
                        <span class="label_text">popular</span>
                    </label>
                    <label class="radio radio-inline">
                        <input type="radio" name="sort_option" value="recent">
                        <i class="input-helper"></i>
                        <span class="label_text">recent</span>
                    </label>
                    <label class="radio radio-inline">
                        <input type="radio" name="sort_option" value="abc">
                        <i class="input-helper"></i>
                        <span class="label_text">abc</span>
                    </label>
                </ul>
            </div>
        </div>
    </div>
</section>

<section id="channels" class="container">
    <div class="row">
        <% @fandoms.each do |fandom| %>
            <div class="col-md_2 col-sm-4 col-xs_5">
                <%= link_to fandom_path(fandom) do %>
                    <div class="card profile-view">
                        <div class="pv-header hf-e-header"  style="background-image: url('<%= fandom.background_img %>')">
                            <img src="<%= fandom.profile_img %>" class="pv-main profile_img absolute_center" alt="" data-pin-nopin="true">
                        </div>

                        <div class="pv-body hf-e-body">
                            <h2 class="text"><%= fandom.name %></h2>

                            <ul class="pv-follow">
                                <li class="text text-sm"><span id="follower_count_<%= fandom.id %>"><%= fandom.user_lists.count %></span> Followers</li>
                            </ul>

                            <% if user_signed_in? %>
                                <%= follow_btn(fandom, current_user).html_safe %>
                            <% else %>
                                <%= follow_btn(fandom, nil).html_safe %>
                            <% end %>
                        </div>
                    </div>
                <% end %>
            </div>
        <% end %>
    </div>

    <% unless @fandoms_not_active.count.zero? %>
        <div class="hf-hr-wrap" style="padding: 0 25%;">
            <hr class="hf-hr" style="border-top: 2px solid #777;">
            <span class="zmdi zmdi-star"></span>
        </div>

        <div class="row unpublished_channels">
            <h2>proposed channels <small>These channels are in preparation. <br>When the proposal reaches 50 people, it will be issued to the official channel.</small></h2>
            <% @fandoms_not_active.each do |un_fandom| %>
                <div class="col-md_2 col-sm-4 col-xs_5">
                    <%= link_to '#', style: 'background: #000' do %>
                        <div class="card profile-view inactive">
                            <div class="pv-header hf-e-header" style="background-image: url('<%= un_fandom.background_img %>')">
                                <img src="<%= un_fandom.profile_img %>" class="pv-main profile_img absolute_center" alt="" data-pin-nopin="true">
                            </div>
                            <div class="pv-body hf-e-body">
                                <h2 class="text"><%= un_fandom.name %></h2>

                                <ul class="pv-follow">
                                    <li class="text text-sm"><span id="follower_count_<%= un_fandom.id %>"><%= un_fandom.user_lists.count %></span> proposers Now</li>
                                </ul>
                                <% if user_signed_in? %>
                                    <% if is_my_fandom?(users_fandom_lists: @my_fandoms, this_fandom: un_fandom) %>
                                        <a id="channel_<%= un_fandom.id %>" onclick="followBtn('cancel', <%= current_user.myfandoms.where(fandom_id: un_fandom.id).take.id %>, <%= un_fandom.id %>, <%= current_user.id %>, 'no-text')" class="proposed_follow_btn btn btn-default waves-effect waves-circle waves-float">
                                            <span class="zmdi zmdi-favorite c-pink"></span>
                                        </a>
                                    <% else %>
                                        <a id="channel_<%= un_fandom.id %>" onclick="followBtn('follow', 0, <%= un_fandom.id %>, <%= current_user.id %>, 'no-text')" class="proposed_follow_btn btn btn-default waves-effect waves-circle waves-float">
                                            <span class="zmdi zmdi-favorite-outline"></span>
                                        </a>
                                    <% end %>
                                <% end %>
                                <a id="channeel_<%= un_fandom.id %>" onclick="" class="pv-follow-btn" style="cursor: pointer">Follow</a>
                            </div>
                        </div>
                    <% end %>
                </div>
            <% end %>
        </div>
    <% end %>
</section>

<div class="modal fade" id="suggest_channel_modal" tabindex="-1" role="dialog" aria-labelledby="addLinkModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header bgm-teal" style="border-top-left-radius: 3px; border-top-right-radius: 3px;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" style="color: #fff">&times;</span></button>
                <h2 class="modal-title" style="color: #ffffff;">Suggest a new Channel</h2>
            </div>
            <form action="<%= fandoms_path %>" method="post">
                <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
                <div class="modal-body">
                    <p class="c-black f-500 m-b-0 f-20">Step 1. Name</p>
                    <div class="input-group fg-float m-t-15 w-100">
                        <div class="fg-line">
                            <input type="text" class="form-control fg-input" name="fandom[name]" id="link_url">
                            <label class="fg-label">Artist's Official Name (Eng)</label>
                        </div>
                    </div>

                    <p class="c-black f-500 m-b-0 m-t-25 f-20">Step 2. Logo</p>
                    <div class="input-group fg-float m-t-15 w-100">
                        <div class="fg-line">
                            <input type="text" class="form-control fg-input" name="fandom[profile_img]" id="link_url">
                            <label class="fg-label">Artist's Official Logo image (Only URL)</label>
                        </div>
                    </div>

                    <p class="c-black f-500 m-b-0 m-t-25 f-20">Step 3. Background</p>
                    <div class="input-group fg-float m-t-15 w-100">
                        <div class="fg-line">
                            <input type="text" class="form-control fg-input" name="fandom[background_img]" id="link_url">
                            <label class="fg-label">Artist's Official Background image (Only URL)</label>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="saveBtn" class="btn bgm-blue" style="text-transform: uppercase;">save</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div style="display: none;">
    <p id="notice"><%= notice %></p>

    <h1>Fandoms</h1>

    <table>
        <thead>
        <tr>
            <th>Name</th>
            <th>Profile img</th>
            <th>Background img</th>
            <th colspan="3"></th>
        </tr>
        </thead>

        <tbody>
        <% @fandoms.each do |fandom| %>
            <tr>
                <td><%= fandom.name %></td>
                <td><%= fandom.profile_img %></td>
                <td><%= fandom.background_img %></td>
                <td><%= link_to 'Show', fandom %></td>
                <td><%= link_to 'Edit', edit_fandom_path(fandom) %></td>
                <td><%= link_to 'Destroy', fandom, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
        <% end %>
        </tbody>
    </table>

    <br>

    <%= link_to 'New Fandom', new_fandom_path %>
</div>