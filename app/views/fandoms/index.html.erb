<%= render partial: '/layouts/plane_header', locals: { color_class: '', message: 'Follow your favorite K-pop STAR!', style: 'background-color: #00c9c6 !important;', msg_style: '' } %>

<% if user_signed_in? %>
    <button id="suggest_btn" class="btn btn-default bgm-lightgreen wave-effect" data-toggle="modal" data-target="#suggest_channel_modal">
        Do you want to suggest a new Channel?
    </button>
<% end %>

<section id="channels" class="container card" style="padding-bottom: 50px;">
    <div id="sorting_methods">
        <div class="row">
            <div class="col-sm-6"></div>
            <div class="col-sm-6" style="padding: 0;">
                <div class="col-md-4"></div>
                <div class="col-md-8" style="padding: 0;">
                    <!--
                    <ul class="methods-wrapper">
                        <label class="radio radio-inline">
                            <input type="radio" name="sort_option" value="popular" checked>
                            <i class="input-helper"></i>
                            <span class="label_text">popular</span>
                        </label>
                        <label class="radio radio-inline">
                            <input type="radio" name="sort_option" value="recent">
                            <i class="input-helper"></i>
                            <span class="label_text">recent</span>
                        </label>
                        <label class="radio radio-inline">
                            <input type="radio" name="sort_option" value="abc">
                            <i class="input-helper"></i>
                            <span class="label_text">abc</span>
                        </label>
                    </ul>
                    -->
                    <ul class="methods-wrapper">
                        <li class="method <%= 'active' if params[:method] == 'abc' %>"><a href="?method=abc" class="methodBtn">abc</a></li>
                        <li class="method <%= 'active' if params[:method] == 'recent' %>"><a href="?method=recent" class="methodBtn">recent</a></li>
                        <li class="method <%= 'active' if params[:method] == 'popular' || params[:method].nil? %>"><a href="?method=popular" class="methodBtn">popular</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="row" style="text-align: left; max-width: 960px; margin: auto; padding: 0 60px;">
        <% @fandoms.each do |fandom| %>
            <div class="" style="width: 250px; margin: 30px 10px 10px; height: 300px; display: inline-table;">

                <%= link_to fandom_path(fandom) do %>
                    <div class="card profile-view" style="margin: 0;">
                        <div class="pv-header hf-e-header"  style="background-image: url('<%= fandom.background_img %>'); height: 125px;">
                            <img src="<%= fandom.profile_img %>" class="pv-main profile_img absolute_center" alt="" data-pin-nopin="true" style="width: 90px; height: 90px; margin-left: -45px; border: 2px solid #fff; box-shadow: 0 0 5px rgba(0, 0, 0, 0.75)">
                        </div>

                        <div class="pv-body hf-e-body">
                            <h2 class="text"><%= fandom.name %></h2>

                            <ul class="pv-follow">
                                <li class="text text-sm"><span id="follower_count_<%= fandom.id %>">Followers <%= fandom.user_lists.count %></span></li>
                            </ul>

                            <% if user_signed_in? %>
                                <%= follow_btn(fandom, current_user).html_safe %>
                            <% else %>
                                <%= follow_btn(fandom, nil).html_safe %>
                            <% end %>
                        </div>
                    </div>
                <% end %>
            </div>
        <% end %>
    </div>

    <% unless @fandoms_not_active.count.zero? %>
        <div class="hf-hr-wrap" style="padding: 0 25%;">
            <!--<hr class="hf-hr" style="border-top: 2px solid #777;">-->
            <!--<span class="zmdi zmdi-star"></span>-->
        </div>

        <div class="row unpublished_channels" style="text-align: left; max-width: 960px; margin-left: auto; margin-right: auto; padding: 0 60px;">
            <h2 style="text-align: left">fandom waiting list <small>These channels are in preparation. <br>When the proposal reaches 50 people, it will be issued to the official channel.</small></h2>
            <% @fandoms_not_active.each do |un_fandom| %>
                <div class="" style="width: 250px; margin: 30px 10px 10px; height: 270px; display: inline-table;">
                    <%= link_to '#', style: 'background: #000' do %>
                        <div class="card profile-view inactive" style="margin: 0;">
                            <div class="pv-header hf-e-header" style="background-image: url('<%= un_fandom.background_img %>'); height: 180px;">
                                <img src="<%= un_fandom.profile_img %>" class="pv-main profile_img absolute_center" alt="" data-pin-nopin="true" style="width: 90px; height: 90px; margin-left: -45px; bottom: 50px; z-index: 2;">
                            </div>
                            <div class="pv-body hf-e-body" style="margin-top: 0;">
                                <h2 class="text" style="margin-top: 17px;"><%= un_fandom.name %></h2>

                                <ul class="pv-follow">
                                    <li class="text text-sm" style="font-size: 30px !important;"><span id="follower_count_<%= un_fandom.id %>"><%= un_fandom.users.count %></span></li>
                                </ul>
                                <% if user_signed_in? %>
                                    <% if is_my_fandom?(user: current_user, fandom: un_fandom) %>
                                        <a id="channel_<%= un_fandom.id %>" onclick="followBtn('cancel', <%= un_fandom.get_myfandom(current_user).id %>, <%= un_fandom.id %>, <%= current_user.id %>, 'no-text')" class="pv-follow-btn followed" style="margin: 13px auto; cursor: pointer;">
                                            <!--<span class="zmdi zmdi-favorite c-pink"></span>-->
                                            Following
                                        </a>
                                    <% else %>
                                        <a id="channel_<%= un_fandom.id %>" onclick="followBtn('follow', 0, <%= un_fandom.id %>, <%= current_user.id %>, 'no-text')" class="pv-follow-btn" style="margin: 13px auto; cursor: pointer;">
                                            <!--<span class="zmdi zmdi-favorite-outline"></span>-->
                                            Follow
                                        </a>
                                    <% end %>
                                <% end %>
                                <!--<a id="channeel_<%#= un_fandom.id %>" onclick="" class="pv-follow-btn" style="cursor: pointer">Follow</a>-->
                            </div>
                        </div>
                    <% end %>
                </div>
            <% end %>
        </div>
    <% end %>
</section>

<div class="modal fade" id="suggest_channel_modal" tabindex="-1" role="dialog" aria-labelledby="addLinkModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h2 class="modal-title">Fandom Suggestions</h2>
            </div>
            <form action="<%= fandoms_path %>" method="post">
                <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
                <div class="modal-body">
                    <p class="m-b-0 f-16">step 1. Name of the Fandom</p>
                    <div class="input-group fg-float m-t-10 w-100">
                        <div class="fg-line">
                            <input type="text" class="form-control fg-input" name="fandom[name]" id="link_url">
                            <label class="fg-label">Artist's Official Name (Eng)</label>
                        </div>
                    </div>

                    <p class="m-b-0 m-t-30 f-16">step 2. Logo of the Fandom</p>
                    <div class="input-group fg-float m-t-10 w-100">
                        <div class="fg-line">
                            <input type="text" class="form-control fg-input" name="fandom[profile_img]" id="link_url">
                            <label class="fg-label">Artist's Official Logo image (Only URL)</label>
                        </div>
                    </div>

                    <p class="m-b-0 m-t-30 f-16">step 3. Background image</p>
                    <div class="input-group fg-float m-t-10 w-100">
                        <div class="fg-line">
                            <input type="text" class="form-control fg-input" name="fandom[background_img]" id="link_url">
                            <label class="fg-label">Artist's Official Background image (Only URL)</label>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="saveBtn" class="btn">next</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div style="display: none;">
    <p id="notice"><%= notice %></p>

    <%= link_to 'New Fandom', new_fandom_path %>
</div>

<style>
    section#page_header{
        margin-bottom: 0;
    }
</style>